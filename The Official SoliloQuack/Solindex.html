<!DOCTYPE html>
<html>

<head>
    <title>SoliloQuack</title>
    <link href="https://fonts.googleapis.com/css?family=Dosis" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Abel|Open+Sans" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="SolStyle.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body background="background.jpg">

    <div id="my_logo"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div id="content">
                    <div id="padding">
                        <img src="SoliloQuackLogoOFFICIAL.png" alt="v cool" width="500" height="320">
                        <h1>SoliloQuack</h1>
                        <h3>revolutionizing the rehearsal experience</h3>
                        <hr>
                        <div class="container">
                            <a href="#section1" class="btn btn-info" role="button">Rehearse</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="black">
        &nbsp;
        <div id="about">

            <p>About</p>
            <hr>
        </div>
        <div id="aboutText">
            <p>Being off-book is crucial to being an actor. It allows the actor to be freed from the worry of line-calling, the distraction of the script-in-hand, and thus enhances their interactions with their fellow actors. On stage, an actor must listen not only for their own cues, but to flow through the play with focus on the movement and overall energy of the scene. Not being off-book distracts from all that. But fear not, talented thespians!</p>
            <div id="Catch">
                <p>SoliloQuack is here to help.</p>
            </div>
            <div id="aboutText">
                <div id="Headlines">
                    <p>How It Works</p>
                </div>
                <p>The HTML Voice Detector will take in your speech and compare it to your inserted monologue. It will then give you accurate and precise feedback about where you've incorrectly said your line. Keep practicing to get off book!</p>
                <div id="Headlines">
                    <p>How We Started</p>
                </div>
                <p>As Computer Scientists and theater-enthusiasts, we know the experience of memorizing lines on your own can be tough. Surprised that no such online program has yet to exist, we decided to join our fields of interest together to fill that void!
                </p>
                <div id="Headlines">
                    <p>How We Named it</p>
                </div>
                <p>Why SoliloQuack? It comes from rubber duck debugging, where a frustrated coder explains their code to an inanimate object (such as a rubber duck) which <em>should-be-working</em> but just...doesn't. With explaining the idea comes a Eureka! The code starts making sense.</p>
                <p> One of the most well known theatre moments is in Hamlet, where in <em>A Churchyard</em> scene, Hamlet talks out his worries to the court jester Yorick's skull. This felt oddly similar to explaining code. Combining Soliloqy with Quack, Hamlet with rubber ducks, and Yorick with Eureka...</p>
                <div="Yoricka">
                    <p>Yoricka the Duck was born.</p>
            </div>
            &nbsp;
            <div id='Headlines'>
                <p>We hope you enjoy! Break a leg.</p>
                <p>-Isabelle & Kamile </p>
                </div>
                <div id="aboutText2">
                <p> Background photo by Debby Hudson on Unsplash. Logo made by Kamile Demir. SoliloQuack was created by Kamile Demir and Isabelle Greenberg at the Hack@CEWIT 2018 Hackathon.</p>
                    <hr>
                </div>
                <div id="theDuck">
                    <img src="SoliloQuackLogoOFFICIAL.png" alt="v cool" width="430" height="250">
            </div>
        </div>
    </div>
    </div>
    <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>









    <h1 id="section1"></h1>
    <h1 class="center" id="headline">
        <a href="http://dvcs.w3.org/hg/speech-api/raw-file/tip/speechapi.html">
    Web Speech API</a> SoliloQuack</h1>
    <div id="white">
        <div id="info">
            <p id="info_start">Click on Start and begin speaking.</p>
            <p id="info_speak_now">Speak now.</p>
            <p id="info_no_speech">No speech was detected. You may need to adjust your
                <a href="//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892">
      microphone settings</a>.</p>
            <p id="info_no_microphone" style="display:none">
                No microphone was found. Ensure that a microphone is installed and that
                <a href="//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892">
    microphone settings</a> are configured correctly.</p>
            <p id="info_allow">Click the "Allow" button above to enable your microphone.</p>
            <p id="info_denied">Permission to use microphone was denied.</p>
            <p id="info_blocked">Permission to use microphone is blocked. To change, go to chrome://settings/contentExceptions#media-stream</p>
            <p id="info_upgrade">Web Speech API is not supported by this browser. Upgrade to <a href="//www.google.com/chrome">Chrome</a> version 25 or later.</p>
        </div>

        <div class="right">
            <button id="start_button" onclick="startButton(event)"> Start</button>

        </div>
        <div id="results">
            <span id="final_span" class="final"></span>
            <span id="interim_span" class="interim"></span>
            <p>
        </div>
        <div class="center">
            <div class="sidebyside" style="text-align:right">
            </div>
            <div class="sidebyside">
            </div>

            <div class="dropdown">
                <div id="div_language">
                    <select id="select_language" onchange="updateCountry()"></select> &nbsp;&nbsp;
                    <select id="select_dialect"></select>
                </div>
            </div>
            <div class="right2">
                Please copy your translation with Control + C and paste into the comparison box below.
            </div>

            <div class="container">
                <h2>Script Comparison</h2>
            </div>
            <div class="right3">
                <p>Copy + Paste your monologue:</p>
            </div>
            <form id="form" onsubmit="return false;">
                <input style="position:bottom; top:80%; left:20%; width:40%; height:40%" type="text" id="userInput" />
                <input style="position:bottom; top:50%; left:5%; width:40%; " type="submit" onclick="othername();" />
            </form>
            &nbsp;
            <div class="right3">
                <p>Copy + Paste from the Web Speech API box: </p>
            </div>
            <form id="form" onsubmit="return false;">
                <input style="position:bottom; top:80%; left:20%; width:40%; height:40%" type="text" id="userInput2" />
                <input style="position:bottom; top:50%; left: 5%; width:40%; " type="submit" onclick="othername2();" />
            </form>
        </div>

        <div class="right4">
            <p>Click below to compare!</p>
        </div>
        <form id="form" onsubmit="return false;">
            &nbsp;
            <input style="position:bottom; top:30%; width:100%; " type="submit" onclick="compare(actorInput,script);" />
        </form>
        <div id="Res">
            <p> Your results are: </p>
            <p id="output1" style="text-align:center"> </p>
            &nbsp;
            <p id="output2" style="text-align:center"> </p>

            <p id="output3" style="text-align:center"> </p>

            <p id="output4" style="text-align:center"> </p>
            &nbsp;
        </div>



        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
        <script>
            var langs = [
                ['Afrikaans', ['af-ZA']],
                ['Bahasa Indonesia', ['id-ID']],
                ['Bahasa Melayu', ['ms-MY']],
                ['Català', ['ca-ES']],
                ['Čeština', ['cs-CZ']],
                ['Deutsch', ['de-DE']],
                ['English', ['en-AU', 'Australia'],
                    ['en-CA', 'Canada'],
                    ['en-IN', 'India'],
                    ['en-NZ', 'New Zealand'],
                    ['en-ZA', 'South Africa'],
                    ['en-GB', 'United Kingdom'],
                    ['en-US', 'United States']
                ],
                ['Español', ['es-AR', 'Argentina'],
                    ['es-BO', 'Bolivia'],
                    ['es-CL', 'Chile'],
                    ['es-CO', 'Colombia'],
                    ['es-CR', 'Costa Rica'],
                    ['es-EC', 'Ecuador'],
                    ['es-SV', 'El Salvador'],
                    ['es-ES', 'España'],
                    ['es-US', 'Estados Unidos'],
                    ['es-GT', 'Guatemala'],
                    ['es-HN', 'Honduras'],
                    ['es-MX', 'México'],
                    ['es-NI', 'Nicaragua'],
                    ['es-PA', 'Panamá'],
                    ['es-PY', 'Paraguay'],
                    ['es-PE', 'Perú'],
                    ['es-PR', 'Puerto Rico'],
                    ['es-DO', 'República Dominicana'],
                    ['es-UY', 'Uruguay'],
                    ['es-VE', 'Venezuela']
                ],
                ['Euskara', ['eu-ES']],
                ['Français', ['fr-FR']],
                ['Galego', ['gl-ES']],
                ['Hrvatski', ['hr_HR']],
                ['IsiZulu', ['zu-ZA']],
                ['Íslenska', ['is-IS']],
                ['Italiano', ['it-IT', 'Italia'],
                    ['it-CH', 'Svizzera']
                ],
                ['Magyar', ['hu-HU']],
                ['Nederlands', ['nl-NL']],
                ['Norsk bokmål', ['nb-NO']],
                ['Polski', ['pl-PL']],
                ['Português', ['pt-BR', 'Brasil'],
                    ['pt-PT', 'Portugal']
                ],
                ['Română', ['ro-RO']],
                ['Slovenčina', ['sk-SK']],
                ['Suomi', ['fi-FI']],
                ['Svenska', ['sv-SE']],
                ['Türkçe', ['tr-TR']],
                ['български', ['bg-BG']],
                ['Pусский', ['ru-RU']],
                ['Српски', ['sr-RS']],
                ['한국어', ['ko-KR']],
                ['中文', ['cmn-Hans-CN', '普通话 (中国大陆)'],
                    ['cmn-Hans-HK', '普通话 (香港)'],
                    ['cmn-Hant-TW', '中文 (台灣)'],
                    ['yue-Hant-HK', '粵語 (香港)']
                ],
                ['日本語', ['ja-JP']],
                ['Lingua latīna', ['la']]
            ];
            for (var i = 0; i < langs.length; i++) {
                select_language.options[i] = new Option(langs[i][0], i);
            }
            select_language.selectedIndex = 6;
            updateCountry();
            select_dialect.selectedIndex = 6;
            showInfo('info_start');
            //CURRENT PLACEMENT OF INPUT, NEED TO CHANGE WITH THE TEXT BOX
            var actorInput;
            var actorSpeech;

            function updateCountry() {
                for (var i = select_dialect.options.length - 1; i >= 0; i--) {
                    select_dialect.remove(i);
                }
                var list = langs[select_language.selectedIndex];
                for (var i = 1; i < list.length; i++) {
                    select_dialect.options.add(new Option(list[i][1], list[i][0]));
                }
                select_dialect.style.visibility = list[1].length == 1 ? 'hidden' : 'visible';
            }
            var script;
            var create_email = false;
            var final_transcript = '';
            var recognizing = false;
            var ignore_onend;
            var start_timestamp;
            if (!('webkitSpeechRecognition' in window)) {
                upgrade();
            } else {
                start_button.style.display = 'inline-block';
                var recognition = new webkitSpeechRecognition();
                recognition.continuous = true;
                recognition.interimResults = true;
                recognition.onstart = function() {
                    recognizing = true;
                    showInfo('info_speak_now');
                    //start_img.src = 'mic-animate.gif';
                };
                recognition.onerror = function(event) {
                    if (event.error == 'no-speech') {
                        //start_img.src = 'mic.gif';
                        showInfo('info_no_speech');
                        ignore_onend = true;
                    }
                    if (event.error == 'audio-capture') {
                        //start_img.src = 'mic.gif';
                        showInfo('info_no_microphone');
                        ignore_onend = true;
                    }
                    if (event.error == 'not-allowed') {
                        if (event.timeStamp - start_timestamp < 100) {
                            showInfo('info_blocked');
                        } else {
                            showInfo('info_denied');
                        }
                        ignore_onend = true;
                    }
                };
                recognition.onend = function() {
                    recognizing = false;
                    if (ignore_onend) {
                        return;
                    }
                    //start_img.src = 'mic.gif';
                    if (!final_transcript) {
                        showInfo('info_start');
                        return;
                    }
                    showInfo('');
                    if (window.getSelection) {
                        window.getSelection().removeAllRanges();
                        var range = document.createRange();
                        range.selectNode(document.getElementById('final_span'));
                        window.getSelection().addRange(range);
                    }
                    if (create_email) {
                        create_email = false;
                        createEmail();
                    }
                };
                recognition.onresult = function(event) {
                    var interim_transcript = '';
                    for (var i = event.resultIndex; i < event.results.length; ++i) {
                        if (event.results[i].isFinal) {
                            final_transcript += event.results[i][0].transcript;
                        } else {
                            interim_transcript += event.results[i][0].transcript;
                        }
                    }
                    final_transcript = capitalize(final_transcript);
                    final_span.innerHTML = linebreak(final_transcript);
                    interim_span.innerHTML = linebreak(interim_transcript);
                    if (final_transcript || interim_transcript) {
                        showButtons('inline-block');
                    }
                };
            }

            function upgrade() {
                start_button.style.visibility = 'hidden';
                showInfo('info_upgrade');
            }
            var two_line = /\n\n/g;
            var one_line = /\n/g;

            function linebreak(s) {
                return s.replace(two_line, '<p></p>').replace(one_line, '<br>');
            }
            var first_char = /\S/;

            function capitalize(s) {
                return s.replace(first_char, function(m) {
                    return m.toUpperCase();
                });
            }

            function copyButton() {
                if (recognizing) {
                    recognizing = false;
                    recognition.stop();
                }
                copy_button.style.display = 'none';
                copy_info.style.display = 'inline-block';
                showInfo('');
            }

            function startButton(event) {
                if (recognizing) {
                    recognition.stop();
                    //console.log(actorSpeech); textToArray(actorInput) textToArray($('#final_span').text())
                    //document.getElementById("actorSpeech").innerHTML;
                    determineOutput();
                    return;
                }
                final_transcript = '';
                recognition.lang = select_dialect.value;
                recognition.start();
                ignore_onend = false;
                final_span.innerHTML = '';
                interim_span.innerHTML = '';
                start_img.src = 'mic-slash.gif';
                showInfo('info_allow');
                showButtons('none');
                start_timestamp = event.timeStamp;
            }

            function showInfo(s) {
                if (s) {
                    for (var child = info.firstChild; child; child = child.nextSibling) {
                        if (child.style) {
                            child.style.display = child.id == s ? 'inline' : 'none';
                        }
                    }
                    info.style.visibility = 'visible';
                } else {
                    info.style.visibility = 'hidden';
                }
            }
            var current_style;

            function showButtons(style) {
                if (style == current_style) {
                    return;
                }
                current_style = style;
                copy_button.style.display = style;
                email_button.style.display = style;
                copy_info.style.display = 'none';
                email_info.style.display = 'none';
            }

            function determineOutput() {
                console.log(textToArray($('#final_span').text()));
                document.getElementById("input_display").innerHTML = textToArray(actorInput);
                document.getElementById("response_display").innerHTML = textToArray($('#final_span').text());
            }

            function textToArray(actor) {
                var actorArray = actor.split(" ");
                var punctuations = ".,:;!?*";
                for (var i = 0; i < actorArray.length; i++) {
                    if (punctuations.includes(actorArray[i][actorArray[i].length - 1]))
                        actorArray[i] = actorArray[i].substring(0, actorArray[i].length - 1);
                }
                return actorArray;
            }

            $('#Hell').on('click', function() {



                /* your code here */
            });

            function othername() {
                script = document.getElementById("userInput").value;
                console.log(script);
            }

            function othername2() {
                actorInput = document.getElementById("userInput2").value;
                console.log(actorInput);
            }

            function compare(actorInput, script) {
                actorInput = textToArray(actorInput);
                script = textToArray(script);
                var matching = 0;
                var missedScript = [];
                var missedInput = [];
                var messedUpIndex = 0;

                for (var i = 0; i < Math.max(actorInput.length, script.length); i++) {
                    if (actorInput[i] == script[i]) {
                        matching++;
                    } else {
                        missedScript[messedUpIndex] = script[i];
                        missedInput[messedUpIndex] = actorInput[i];
                        messedUpIndex++;
                    }
                }
                var percentRight = (matching / script.length) * 100;
                var output1 = "You got: " + percentRight + "% correct.";
                var output2 = "The specific words you switched up were:";
                var output4 = "What you said: " + missedInput;
                var output3 = "What you should've said : " + missedScript;

                document.getElementById("output1").innerHTML = output1;
                document.getElementById("output2").innerHTML = output2;
                document.getElementById("output3").innerHTML = output3;
                document.getElementById("output4").innerHTML = output4;


            }
        </script>
</body>

</html>
